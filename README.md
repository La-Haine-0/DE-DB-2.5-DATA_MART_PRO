# DE-DB-2.5-DATA_MART_PRO
## Исходные данные:
- Набор таблиц, которые содержат информацию о продажах некоторых товаров в 3-х различных магазинах, а также таблицу с планами продаж на уровень каждого магазина и каждого товара. 
- В таблицах вида «shop_…» представлена информация о количестве продаж того или иного товара за конкретный день;
- В таблице plan хранится информация о планировании по продажам тех или иных товаров на конец месяца;
- В таблице products хранится общая информация по каждому из товаров;
- Линейка насчитывает целых 3 модели: «Испорченный телефон», «Сарафанное радио» и «Патефон».
## Задание:
1) Добавить недостающую таблицу;
2) Собрать витрину-разработать SQL-скрипт, который формирует таблицу со следующим набором атрибутов:
- shop_name — название магазина,
- product_name — название товара,
- sales_fact — количество фактических продаж на конец месяца,
- sales_plan — количество запланированных продаж на конец месяца,
- sales_fact/sales_plan — отношение количества фактических продаже к запланированному,
- income_fact — фактический доход,
- income_plan — планируемый доход,
- income_fact/income_plan — отношение фактического дохода к запланированному,
- avg(sales/date) - среднее количество продаж в день,
- max_sales - максимальное количество продаж за один день,
- date_max_sales - день, в который произошло максимальное количество продаж,
- date_max_sales_is_promo - факт того, действовала ли скидка в тот день, когда произошло максимальное количество продаж,
- avg(sales/date) / max_sales - отношение среднего количества продаж к максимальному,
- promo_len - количество дней месяце когда на товар действовала скидка,
- promo_sales_cnt - количество товаров проданных в дни скидок,
- promo_sales_cnt/fact_sales - отношение количества товаров проданных в дни скидки к общему количеству проданных товаров за месяц,
- promo_income - доход с продаж в дни акций,
- promo_income/fact_income - отношение дохода с продаж в дни акций к общему доходу с продаж за месяц.
## Решение:
- Составленная схема БД представлена на ER-диаграмме по ссылке: (<code>[DATA_MART.png](https://github.com/La-Haine-0/DE-DB-2.5-DATA_MART/blob/main/DATA_MART.png)</code>);
- Скрипт запроса на создание витрины: (<code>[quest.sql](https://github.com/La-Haine-0/DE-DB-2.5-DATA_MART/blob/main/quest.sql)</code>).
## Запуск проекта:
Для просмотра проекта достаточно склонировать его себе на локальный компьютер, иметь установленным docker-compose и ввести команду:
```sh
docker-compose up -d
```
- Далее база данных доступна в контейнере, либо по порту 5432 из любого сервиса для подключения к БД (можно использовать DBeaver).